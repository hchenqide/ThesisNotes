## replacing cadical with minisat in cvc5

### first steps (11.04 - 13.04)

> compiling cvc5 with minisatup interface, linking to minisat manually, without functions to be defined

- build and install minisat:
  minisat/build$
  `cmake ..`
  `make`
  `cmake --install . --prefix ./install`

- manually create minisat link in cvc5 build folder:
  cvc5/build/deps/include$
  `ln -s ../../../../minisat/minisat minisatup`
  cvc5/build/deps/lib$
  `ln -s ../../../../minisat/build/install/lib/libminisat.a`

- cvc5 builds incrementally:
  cvc5/build$
  `make -j$(( $(nproc) + 1 ))`

- debug run cvc5
  `./cvc5/build/bin/cvc5`

- create minisatup.h/.cpp copying from cadical.h/.cpp

- create single wrapper header for minisat (minisat include files contains internal header files that are not easy to compile together):
  add minisat/minisatup.h to install destination
  add minisat/minisatup.cc to library source

- rename symbols in cvc5 minisatup.h/.cpp, include directly <minisatup.h>, add matching functions in minisat minisatup.h from cadical.h
  include prop/minisatup.h in sat_solver_factory replacing CadicalSolver so MinisatUPSolver can be linked
  cvc5 now compiles, but not links yet (cvc5 call dynamic lib which doesn't contain libminisat, with: symbol lookup error: cvc5/build/src/libcvc5.so.1: undefined symbol: _ZN9MinisatUP6SolverC1Ev)

- add line `src/libcvc5.so.1: deps/lib/libminisat.a` in cvc5/build/src/CMakeFiles/cvc5.dir/build.make, doesn't make a difference
  add option `../deps/lib/libminisat.a` in cvc5/build/src/CMakeFiles/cvc5.dir/link.txt, which is generated by cmake, works, with following error on every function:
  /usr/bin/ld.gold: error: ../deps/lib/libminisat.a(minisatup.cc.o): requires dynamic R_X86_64_PC32 reloc against '__asan_option_detect_stack_use_after_return' which may overflow at runtime; recompile with -fPIC

- add -fPIC compile flag in minisat cmake:
  set(CMAKE_POSITION_INDEPENDENT_CODE ON)
  compiles

- error when running:
  cvc5/build/bin/cvc5: symbol lookup error: /mnt/e/Freiburg/25s/thesis/cvc5/build/src/libcvc5.so.1: undefined symbol: __asan_option_detect_stack_use_after_return

- remove lines in minisat cmake
  add_compile_options(-fsanitize=address)
  add_link_options(-fsanitize=address)

- now it's new error, which means the functions are not yet defined:
  /cvc5/build/bin/cvc5: symbol lookup error: //cvc5/build/src/libcvc5.so.1: undefined symbol: _ZN9MinisatUP6Solver3setEPKci

### todo

- implement functions in minisatup
- (done, step 4) build cvc5 in debug mode
- (done, step 2) link libminisat.a to cvc5 with cmake target_link_libraries and INSTALL_INTERFACE

### suggestions

- cvc5: (already done) move cadical header file to cpp

- cadical: create single header file for ipasirup interface in cadical, without other cacidal interfaces. the ipasirup interface can then be applied in cvc5 and minisat
